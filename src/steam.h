#pragma once

typedef struct steam_table_entry
{
    double pressure;    // MPa
    double temperature; // °C
    double h_water;     // Specific enthalpy of liquid water (kJ/kg)
    double h_steam;     // Specific enthalpy of saturated steam (kJ/kg)
} steam_table_entry_t;

steam_table_entry_t steam_table[] = 
{
    // Pressure (MPa) | Temperature (°C) | h_water (kJ/kg) | h_steam (kJ/kg)
    {7.0, 250, 1087.3, 2799.5},
    {7.0, 275, 1185.2, 2772.8},
    {7.0, 285, 1230.4, 2756.1},  // Typical BWR-4 operating point
    {7.0, 300, 1315.8, 2725.3},
    {7.5, 285, 1220.7, 2748.9},
    {6.5, 285, 1240.1, 2763.2},

    {0.000612, 0.01, 2500.9, 2500.9},
    {0.000873, 5.0, 2510.1, 2489.0},
    {0.001228, 10.0, 2519.2, 2477.2},
    {0.001706, 15.0, 2528.3, 2465.4},
    {0.002339, 20.0, 2537.4, 2453.5},
    {0.003170, 25.0, 2546.5, 2441.7},
    {0.004247, 30.0, 2555.5, 2429.8},
    {0.005629, 35.0, 2564.5, 2417.9},
    {0.007385, 40.0, 2573.5, 2406.0},
    {0.009595, 45.0, 2582.4, 2394.0},
    {0.012352, 50.0, 2591.3, 2381.9},
    {0.015762, 55.0, 2600.1, 2369.8},
    {0.019946, 60.0, 2608.8, 2357.7},
    {0.025042, 65.0, 2617.5, 2345.4},
    {0.031201, 70.0, 2626.1, 2333.0},
    {0.038595, 75.0, 2634.6, 2320.6},
    {0.047414, 80.0, 2643.0, 2308.0},
    {0.057867, 85.0, 2651.3, 2295.3},
    {0.070182, 90.0, 2659.5, 2282.5},
    {0.084608, 95.0, 2667.6, 2269.5},
    {0.10142, 100.0, 2675.6, 2256.4},
    {0.12090, 105.0, 2683.4, 2243.1},
    {0.14338, 110.0, 2691.1, 2229.6},
    {0.16918, 115.0, 2698.6, 2216.0},
    {0.19867, 120.0, 2705.9, 2202.1},
    {0.23224, 125.0, 2713.1, 2188.0},
    {0.27028, 130.0, 2720.1, 2173.7},
    {0.31323, 135.0, 2726.9, 2159.1},
    {0.36154, 140.0, 2733.4, 2144.3},
    {0.41568, 145.0, 2739.8, 2129.2},
    {0.47616, 150.0, 2745.9, 2113.7},
    {0.54350, 155.0, 2751.8, 2098.0},
    {0.61823, 160.0, 2757.4, 2082.0},
    {0.70093, 165.0, 2762.8, 2065.6},
    {0.79219, 170.0, 2767.9, 2048.8},
    {0.89260, 175.0, 2772.7, 2031.7},
    {1.0028, 180.0, 2777.2, 2014.2},
    {1.1235, 185.0, 2781.4, 1996.2},
    {1.2552, 190.0, 2785.3, 1977.9},
    {1.3988, 195.0, 2788.8, 1959.0},
    {1.5549, 200.0, 2792.0, 1939.7},
    {1.7243, 205.0, 2794.8, 1919.9},
    {1.9077, 210.0, 2797.3, 1899.6},
    {2.1058, 215.0, 2799.3, 1878.8},
    {2.3196, 220.0, 2800.9, 1857.4},
    {2.5497, 225.0, 2802.1, 1835.4},
    {2.7971, 230.0, 2802.9, 1812.7},
    {3.0625, 235.0, 2803.2, 1789.4},
    {3.3469, 240.0, 2803.0, 1765.4},
    {3.6512, 245.0, 2802.2, 1740.7},
    {3.9762, 250.0, 2800.9, 1715.2},
    {4.3229, 255.0, 2799.1, 1688.8},
    {4.6923, 260.0, 2796.6, 1661.6},
    {5.0853, 265.0, 2793.5, 1633.5},
    {5.5030, 270.0, 2789.7, 1604.4},
    {5.9464, 275.0, 2785.2, 1574.3},
    {6.4166, 280.0, 2779.9, 1543.0},
    {6.9147, 285.0, 2773.7, 1510.5},
    {7.4418, 290.0, 2766.7, 1476.7},
    {7.9991, 295.0, 2758.7, 1441.4},
    {8.5879, 300.0, 2749.6, 1404.6},
    {9.2094, 305.0, 2739.4, 1366.1},
    {9.8651, 310.0, 2727.9, 1325.7},
    {10.556, 315.0, 2715.1, 1283.2},
    {11.284, 320.0, 2700.6, 1238.4},
    {12.051, 325.0, 2684.3, 1190.8},
    {12.858, 330.0, 2666.1, 1140.2},
    {13.707, 335.0, 2645.4, 1085.9},
    {14.601, 340.0, 2621.8, 1027.3},
    {15.541, 345.0, 2594.9, 963.4},
    {16.529, 350.0, 2563.6, 892.7},
    {17.570, 355.0, 2526.6, 812.9},
    {18.666, 360.0, 2481.5, 719.8},
    {19.821, 365.0, 2422.9, 605.2},
    {21.044, 370.0, 2334.5, 443.8},
    {22.064, 373.946, 2084.3, 2084.3},  
    
    {0.04, 75.86, 2636.1, 2318.4},
    {0.05, 81.32, 2645.2, 2304.7},
    {0.06, 85.93, 2652.9, 2292.9},
    {0.07, 89.93, 2659.4, 2282.7},
    {0.08, 93.49, 2665.2, 2273.5},
    {0.09, 96.69, 2670.3, 2265.1},
    {0.10, 99.61, 2674.9, 2257.4},
    {0.12, 104.78, 2683.1, 2243.7},
    {0.14, 109.29, 2690.0, 2231.6},
    {0.16, 113.30, 2696.0, 2220.7},
    {0.18, 116.91, 2701.4, 2210.7},
    {0.20, 120.21, 2706.2, 2201.5},
    {0.25, 127.41, 2716.5, 2181.1},
    {0.30, 133.52, 2724.9, 2163.5},
    {0.35, 138.86, 2732.0, 2147.7},
    {0.40, 143.61, 2738.1, 2133.4},
    {0.50, 151.83, 2748.1, 2108.0},
    {0.60, 158.83, 2756.1, 2085.8},
    {0.70, 164.95, 2762.8, 2065.8},
    {0.80, 170.41, 2768.3, 2047.4},
    {0.90, 175.35, 2773.0, 2030.5},
    {1.00, 179.88, 2777.1, 2014.6},
    {1.10, 184.06, 2780.6, 1999.6},
    {1.20, 187.96, 2783.7, 1985.4},
    {1.30, 191.61, 2786.5, 1971.9},
    {1.40, 195.04, 2788.8, 1958.9},
    {1.50, 198.29, 2791.0, 1946.4},
    {1.60, 201.37, 2792.8, 1934.4},
    {1.70, 204.31, 2794.5, 1922.7},
    {1.80, 207.11, 2795.9, 1911.4},
    {1.90, 209.80, 2797.2, 1900.5},
    {2.00, 212.38, 2798.3, 1889.8},
    {2.20, 217.25, 2800.1, 1869.2},
    {2.40, 221.79, 2801.4, 1849.6},
    {2.60, 226.05, 2802.3, 1830.7},
    {2.80, 230.06, 2802.9, 1812.4},
    {3.00, 233.85, 2803.2, 1794.8},
    {3.20, 237.46, 2803.1, 1777.7},
    {3.40, 240.90, 2802.9, 1761.0},
    {3.60, 244.18, 2802.4, 1744.8},
    {3.80, 247.33, 2801.7, 1728.9},
    {4.00, 250.35, 2800.8, 1713.3},
    {4.20, 253.26, 2799.8, 1698.1},
    {4.40, 256.07, 2798.6, 1683.1},
    {4.60, 258.78, 2797.3, 1668.4},
    {4.80, 261.40, 2795.8, 1653.9},
    {5.00, 263.94, 2794.2, 1639.6},
    {5.50, 269.97, 2789.7, 1604.6},
    {6.00, 275.59, 2784.6, 1570.7},
    {6.50, 280.86, 2778.9, 1537.5},
    {7.00, 285.83, 2772.6, 1505.3},
    {7.50, 290.54, 2765.9, 1473.3},
    {8.00, 295.01, 2758.7, 1441.4},
    {8.50, 299.27, 2751.1, 1410.1},
    {9.00, 303.35, 2742.9, 1379.1},
    {9.50, 307.25, 2734.4, 1348.2},
    {10.00, 311.00, 2725.5, 1317.4},
    {11.00, 318.08, 2706.3, 1255.9},
    {12.00, 324.68, 2685.4, 1194.3},
    {13.00, 330.85, 2662.7, 1131.2},
    {14.00, 336.67, 2637.9, 1066.9},
    {15.00, 342.16, 2610.7, 1000.5},
    {16.00, 347.36, 2580.8, 931.1},
    {17.00, 352.29, 2547.5, 857.5},
    {18.00, 356.99, 2509.8, 777.7},
    {19.00, 361.47, 2466.6, 688.9},
    {20.00, 365.75, 2412.3, 585.1},
    {21.00, 369.83, 2338.6, 451.4},
    {22.064, 373.946, 2084.3, 2084.3},

    {7.0, 260, 1145.2, 2783.4},
    {7.0, 270, 1201.7, 2768.9},
    {7.2, 285, 1228.9, 2753.2},
    {6.8, 285, 1232.1, 2759.4},
    {7.0, 290, 1265.3, 2741.7},
    {7.0, 295, 1290.4, 2729.8}
};

#define STEAM_TABLE_SIZE (sizeof(steam_table) / sizeof(steam_table_entry_t))

void get_enthalpies(double pressure, double temperature, double* h_water, double* h_steam);
double get_water_density(double pressure, double temperature, double boiling_point) ;
double calculate_void_fraction(double h_liquid, double h_actual, double h_vapor) ;